---
title: "artifact"
author: "ES3"
date: "December 9, 2017"
output: html_document
---

```{r, include=FALSE}
#install.packages("ggplot2")
#install.packages("glmnet")
#install.packages("tidyr")

library(ggplot2)
library(glmnet)
library(tidyr)

#setwd("~/University of Washington/Senior/Fall/Info 370/project-es3")

data <- read.csv("data/clean_num.csv")

```

# Decision Context
Currently University of Washington students spend time between academic work, part or full time jobs, and then finding future positions. Our model focuses on making recommendations on efficently finding the next position by maximizing your efforts and time. The recommendations are about what skills you can develop and what resources you can effectively find a job.

# Model


# Scatter Plot
First, we plotted scatter plot of a number of the months for job searching by a number of students at each type of job to determine when to stop job searching using the same method.
```{r}
ggplot(data = data) +
  geom_count(mapping = aes(x = Job_type, y = Months), alpha = 1/3) + scale_size_area(max_size = 10) + 
  labs(title = "Plot of Months by Number of Students in each Type of Job",
       x = "Types of Job", y = "Months Job Searching Took", size = "Number of People")

```
The scatter plot is suggesting that spending maximum of 7 months is adequate for job searching. Although some students got an offer spending more than a year, it is highly recommended to change the job searching method if the months spent on job search passes 7 months.

# Linear Regression Model
In order to analyze the job search resources that offer highest rates of a job, we implemented linear regression model. Iterating through the variables, we ran simple linear regression model to discover linear relationships between each resource as an input variable and the months of job searching as an output variable.
```{r}
#linear regression for each factor against the outcome variable (months it takes to find job)
#internship = 1, part time = 2, full time = 3
#female = 1, male = 0
for (i in 1:ncol(data)){
  print(ggplot(data, aes(x = data[[i]], y = Months)) +
    geom_point(alpha = 0.1) +
    geom_smooth(method=lm) +
      labs(x = colnames(data)[i]))
}

```
According to the simple linear regression models of resources, too much time input on one resource extends the time of getting a job. However, utilizing employer campus visit, employer website resource, Huskyjobs, and connection decreases the time of receiving an offer.

# Additional Linear Regression
There was unusual trends in our linear regression that points doubt on our expectation: Better major GPA results in more time of getting a job while cumulative GPA has opposite trends. Of course, it is crucial to maintain high cumulative GPA for employment. However, it is not logical to argue that the higher major GPA postpones the duration of job searching. Therefore, we plotted additional GPA graphs with removed values of 0.0.
```{R}
#additional gpa graphs to remove values of 0.0 for GPA
ggplot(data, aes(x = in.major_GPA, y = Months)) +
  geom_point(alpha = 0.1 ) + 
  xlim(2,4) +
  geom_smooth(method=lm) 

ggplot(data, aes(x = cumulative_GPA, y = Months)) +
  geom_point(alpha = 0.1 ) + 
  xlim(2,4) +
  geom_smooth(method=lm)

```
Unfortunately, there was no change in our results. We maintain that these are our limitations/variables resulted from data collection.

# Lasso Regression
For the multi-feature problem in linear regression, we used L1 regulation Lasso to model mean squared error.
```{r}

month <- data[, "Months"]

# Create dataframe 
df = data.frame(data$Months, data$resume_hrs, data$cover_letter_hours, data$self.confidence, data$online_job_postings, data$no_career_fairs, data$cumulative_GPA, data$in.major_GPA, data$internships)

x <- as.matrix(df[-1]) # Removes month
y <- as.matrix(df[, 1]) # Only month

# Plot Mean Squared Error Plot and Lasso path using glmnet
cvfit <- cv.glmnet(x, y,parallel=TRUE, standardize=TRUE, alpha=1, nlambda=1000)
fit <- glmnet(x, y, standardize=TRUE, alpha=1, nlambda=1000)
plot(fit)
plot(cvfit)

```
As lambda increases, the lasso removes more and more coefficients by setting them to zero. Also, there are two minima for graph: around log(lambda) of -1.3 with the number of non-zero coefficient 6 and the log(lambda) of 0 with the number of non-zero coefficient 1. Thus, the model is telling less number of factors makes better result for success in employment.

# Coefficient of Lasso Regression
We analyzed the coefficient of lasso model in order to observe the pattern.
```{r}
coef(fit)
```
The coefficient of lasso model shows increasing pattern of a number of career fairs student attended, despite decreasing pattern of cumulative GPA and number of internships. The number of career fairs, cumulative gpa, and internship is major factors that affect the result of employment.

# Scatter Plot
We plotted the observation from the coefficeint of lasso model 
```{r}
ggplot(data, aes(x= data$no_career_fairs, y = data$Months)) + geom_point(alpha = .1)
ggplot(data, aes(x= data$cumulative_GPA, y = data$Months)) + geom_point(alpha = .1)
ggplot(data, aes(x= data$internships, y = data$Months)) + geom_point(alpha = .1)
```
The graph tells us that more attendance at career fairs results in more number of months to get employed. However, there is an irony behind this explanation: “It is a natural phenomenon that time spent on job application increases when a student goes to career fair often”. Despite the irony, maintaining high cumulative GPA and internship experience is fatal that cumulative GPA and internships are highly related to the highest rates of job offers.

# Limitation

# Results
